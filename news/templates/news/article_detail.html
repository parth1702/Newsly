{% extends 'news/base.html' %}

{% block title %}{{ article.title|default:"Article Detail" }} - Briefly{% endblock %}

{% block content %}
<div class="fade-in">
    <!-- Breadcrumb -->
    <div class="row mb-4">
        <div class="col-12">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb glass-card rounded px-3 py-2">
                    <li class="breadcrumb-item">
                        <a href="{% url 'news:home' %}" class="text-decoration-none">
                            <i class="fas fa-home me-1"></i>Home
                        </a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="{% url 'news:article_list' %}" class="text-decoration-none">
                            <i class="fas fa-list me-1"></i>Articles
                        </a>
                    </li>
                    <li class="breadcrumb-item active fw-medium" aria-current="page">
                        Article Details
                    </li>
                </ol>
            </nav>
        </div>
    </div>

    <div class="row g-4">
        <!-- Main Article Content -->
        <div class="col-lg-8">
            <article class="card border-0 mb-4">
                <div class="card-body p-5">
                    <!-- Article Meta -->
                    <div class="d-flex flex-wrap justify-content-between align-items-center mb-4">
                        <div class="d-flex align-items-center gap-3 mb-2">
                            {% if article.category %}
                                <span class="badge bg-primary px-3 py-2 fs-6">{{ article.category }}</span>
                            {% else %}
                                <span class="badge bg-secondary px-3 py-2 fs-6">General</span>
                            {% endif %}
                            <span class="text-secondary fw-medium">
                                <i class="fas fa-calendar-alt me-2"></i>
                                {{ article.publication_date|date:"F d, Y" }}
                            </span>
                        </div>
                        <div class="text-secondary">
                            <i class="fas fa-clock me-1"></i>
                            ~{% widthratio article.full_text|wordcount 200 1 %} min read
                        </div>
                    </div>
                    
                    <!-- Article Title -->
                    <h1 class="display-6 fw-bold mb-4 lh-base">
                        {% if article.title %}
                            {{ article.title }}
                        {% else %}
                            Article Summary
                        {% endif %}
                    </h1>
                    
                    <!-- AI Summary Section -->
                    <div class="card border-0 bg-gradient mb-5" style="background: linear-gradient(135deg, rgba(79, 172, 254, 0.1) 0%, rgba(0, 242, 254, 0.1) 100%);">
                        <div class="card-body p-4">
                            <div class="d-flex align-items-center mb-3">
                                <div class="bg-primary bg-opacity-10 rounded-circle p-2 me-3">
                                    <i class="fas fa-robot text-primary fa-lg"></i>
                                </div>
                                <h5 class="fw-bold mb-0">AI-Powered Summary</h5>
                            </div>
                            {% if article.summary %}
                                <p class="fs-5 lh-lg mb-0 text-high-contrast">{{ article.summary }}</p>
                            {% else %}
                                <p class="text-secondary fst-italic mb-0">Summary processing in progress...</p>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Full Article Content -->
                    <div class="article-content">
                        <h3 class="fw-bold mb-4">
                            <i class="fas fa-newspaper me-2 text-primary"></i>
                            Complete Article
                        </h3>
                        <div class="fs-6 lh-lg text-justify">
                            {{ article.full_text|linebreaks }}
                        </div>
                    </div>
                    
                    <!-- Article Footer -->
                    <div class="border-top pt-4 mt-5">
                        <div class="row align-items-center">
                            <div class="col-md-6">
                                <small class="text-muted d-flex align-items-center">
                                    <i class="fas fa-plus-circle me-2"></i>
                                    Added to library: {{ article.created_at|date:"F d, Y \a\t g:i A" }}
                                </small>
                            </div>
                            <div class="col-md-6 text-md-end mt-2 mt-md-0">
                                <a href="{{ article.url }}" target="_blank" class="btn btn-success btn-lg">
                                    <i class="fas fa-external-link-alt me-2"></i>Read Original Source
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </article>
        </div>
        
        <!-- Sidebar -->
        <div class="col-lg-4">
            <!-- Article Stats -->
            <div class="card border-0 mb-4">
                <div class="card-header bg-primary bg-opacity-10 border-0">
                    <h5 class="fw-bold mb-0">
                        <i class="fas fa-chart-bar me-2 text-primary"></i>
                        Article Insights
                    </h5>
                </div>
                <div class="card-body p-4">
                    <div class="row g-3">
                        <div class="col-6">
                            <div class="text-center p-3 bg-light rounded">
                                <div class="fw-bold fs-4 text-primary">{{ article.full_text|wordcount }}</div>
                                <small class="text-muted">Words</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="text-center p-3 bg-light rounded">
                                <div class="fw-bold fs-4 text-success">{% widthratio article.full_text|wordcount 200 1 %}</div>
                                <small class="text-muted">Min Read</small>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="my-4">
                    
                    <div class="mb-3">
                        <h6 class="fw-semibold mb-2">
                            <i class="fas fa-tag me-2"></i>Category
                        </h6>
                        <span class="badge bg-primary fs-6 px-3 py-2">
                            {{ article.category|default:"General" }}
                        </span>
                    </div>
                    
                    <div class="mb-3">
                        <h6 class="fw-semibold mb-2">
                            <i class="fas fa-globe me-2"></i>Source
                        </h6>
                        <a href="{{ article.url }}" 
                           target="_blank" 
                           class="text-decoration-none fw-medium text-break">
                            {{ article.url|truncatechars:45 }}
                        </a>
                    </div>
                    
                    <div>
                        <h6 class="fw-semibold mb-2">
                            <i class="fas fa-plus-circle me-2"></i>Added
                        </h6>
                        <span class="text-muted">{{ article.created_at|date:"M d, Y" }}</span>
                    </div>
                </div>
            </div>
            
            <!-- Share Card -->
            <div class="card border-0 mb-4">
                <div class="card-header bg-success bg-opacity-10 border-0">
                    <h5 class="fw-bold mb-0">
                        <i class="fas fa-share-alt me-2 text-success"></i>
                        Share This Story
                    </h5>
                </div>
                <div class="card-body p-4">
                    <div class="d-grid gap-3">
                        <a href="https://twitter.com/intent/tweet?text={{ article.title|urlencode }}&url={{ request.build_absolute_uri }}" 
                           target="_blank" 
                           class="btn btn-outline-info d-flex align-items-center">
                            <i class="fab fa-twitter me-2"></i>Share on Twitter
                        </a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" 
                           target="_blank" 
                           class="btn btn-outline-primary d-flex align-items-center">
                            <i class="fab fa-facebook me-2"></i>Share on Facebook
                        </a>
                        <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ request.build_absolute_uri }}" 
                           target="_blank" 
                           class="btn btn-outline-secondary d-flex align-items-center">
                            <i class="fab fa-linkedin me-2"></i>Share on LinkedIn
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="card border-0">
                <div class="card-header bg-warning bg-opacity-10 border-0">
                    <h5 class="fw-bold mb-0">
                        <i class="fas fa-bolt me-2 text-warning"></i>
                        Quick Actions
                    </h5>
                </div>
                <div class="card-body p-4">
                    <div class="d-grid gap-2">
                        <a href="{% url 'news:article_list' %}" class="btn btn-outline-primary">
                            <i class="fas fa-list me-2"></i>Browse All Articles
                        </a>
                        <a href="{% url 'news:scrape_articles' %}" class="btn btn-outline-success">
                            <i class="fas fa-plus me-2"></i>Add More Articles
                        </a>
                        <a href="{% url 'news:home' %}" class="btn btn-outline-secondary">
                            <i class="fas fa-home me-2"></i>Back to Home
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<style>
.article-content {
    font-size: 1.1rem;
    line-height: 1.8;
    text-align: justify;
    color: #f8fafc !important;
}
.article-content p {
    margin-bottom: 1.2rem;
    color: #f8fafc !important;
    font-weight: 400;
}
.article-content div {
    color: #f8fafc !important;
}
/* AI Summary text visibility */
.text-high-contrast {
    color: #f8fafc !important;
}
/* Card body text improvements */
.card-body p,
.card-body div,
.card-body .fs-5,
.card-body .lh-lg {
    color: #f8fafc !important;
}
</style>
{% endblock %}
